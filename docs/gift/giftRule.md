# 🎁 終極交換禮物：人心博弈版

**The Ultimate Gift Exchange: Strategy & Chaos**

**歡迎來到這場考驗運氣、策略與人品的交換禮物大會。在這裡，拿到好禮物是本事，避開爛禮物是運氣，能笑到最後的才是贏家。**

## 🎯 階段零：準備與偽裝 (Preparation)

1. **雙重獻禮****：每位玩家需準備兩份禮物。**
   * **😇 禮物 A (好禮物)****：大家都想要的夢幻逸品。**
   * **😈 禮物 B (鬧禮物)****：搞怪、無用或令人哭笑不得的地獄梗。**
2. **盲盒描述****：玩家需為自己的禮物提供 3 個 Hashtag 與一句話 Slogan。**
   * *注意：描述越吸引人（或越具欺騙性），遊戲越精彩！*

## 🔥 階段一：R1 理想分配 (Ideal Allocation)

**目標：讓每個人都選到一個「好禮物」。**

1. **同時指名****：所有人同時在系統上選擇自己想要的「好禮物」。**
2. **配對結算****：**
   * **唯一配對****：恭喜！該禮物直接歸你。**
   * **多人搶奪****：觸發 ****PK 決鬥****！。**
     * **點數大者****：勝出獲得禮物。**
     * **點數小者****：落敗，進入下一輪 (R2) 繼續挑選剩餘禮物。**
     * *註：PK 點數將影響最終階段順位（點數越小越可憐，順位越前面）。*
3. **拆封與決策 (關鍵點!)****：**
   * **獲得禮物後當場拆封。**
   * **🔒 鎖定 (Lock)****：立刻保護禮物。此禮物在最終階段 ****免疫搶奪****，但你將失去主動交換權。**
   * **🔓 不鎖定 (Unlock)****：暫時持有。此禮物在最終階段 ****可被用來交換****，也可能被搶走。**

## 🗳️ 階段二：S1 民主制裁 (Democratic Voting)

**目標：決定場上的「鬧禮物」該歸誰，並進行集體霸凌。**

1. **全民公投****：針對場上的「鬧禮物」逐一投票。**
   * **大家要投票決定「誰最適合（或最該死）拿這個禮物」。**
   * **權重****：禮物提供者擁有 ****2 票****，其餘玩家 ****1 票****。**
2. **強制分配****：得票最高者，「被迫」收下該鬧禮物並當場拆封。**
3. **⚠️ 特別條款：絕對多數霸凌 (The 2/3 Rule)**
   * **若該玩家的得票數超過總人數的 ****2/3****。**
   * **該鬧禮物 ****強制鎖定 (Forced Lock)****！**
   * *你只能含淚收下，無法在下一階段把它換出去。*
4. **一般決策****：若未被強制鎖定，得主可自行決定是否 ****🔒 鎖定** 或 **🔓 不鎖定****。**

## ⚔️ 階段三：S2 最終搶奪 (The Final Steal)

**目標：動用你的交換權，進行最後的翻盤。**

### 1. 誰有資格？

只有手中有 至少一個「未鎖定」禮物 的玩家可以參與。

(若兩份禮物都已鎖定，恭喜你安全下莊，請在一旁看戲。)

### 2. 誰先動手？ (順位權重)

**越弱勢的人，越有優先權：**

1. **R 輪次****：越晚拿到好禮物的人優先 (R3 > R2 > R1)。**
2. **PK 值****：PK 運氣越差 (點數小) 的人優先。**
3. **仇恨值****：S1 得票數越低的人優先。**
4. **敬老尊賢****：年長者優先。**

### 3. 如何交換？ (上帝之手)

**輪到你時，你可以發動一次交換：**

* **標的限制****：場上所有 ****🔓 未鎖定** 的禮物（不論是好是鬧、也不論是誰的）。
* **交換方式****：**
  * **換自己的****：拿這爛東西去換別人的好東西。**
  * **換別人的 (上帝視角)****：看 A 和 B 不爽？強制交換 A 和 B 的禮物，自己不加入。**
* **回合結束****：交換發生後，涉及的禮物持有者需 ****馬上決定是否鎖定** 剛剛拿到的禮物。

### 🏆 遊戲結束

當所有擁有交換權的人都執行完畢（或選擇放棄），遊戲結束。

大家帶著手上最終的禮物（與破碎的友誼）回家！

---

網頁設計說明()

## GiftExchange




1. **玩家端 (手機)**：輸入資訊、許願、查看狀態。
2. **主控台 (大螢幕/筆電)**：控制流程、輸入得主、管理鎖定、揭曉謎底。

---

### 🛠️ 程式碼修改重點 (System Changelog)

1. **首頁即登入 (Login & Data Entry)**
   * **修改**：將首頁改為表單。
   * **功能**：玩家加入時必須一次填寫 **暱稱**、**好禮物 (Slogan/Tag)**、**鬧禮物 (Slogan/Tag)**。送出後資料會直接進入禮物池。
2. **神祕感機制 (Hidden Providers)**
   * **修改**：預設隱藏禮物提供者 (`From: ???`)。
   * **功能**：在主控台按下「👁️ 揭曉來源」之前，玩家端看不到這禮物是誰送的，增加盲盒刺激感。
3. **R1 決戰得主控制 (PK Modal)**
   * **修改**：主控台的「公布得主」按鈕改為開啟一個 **模態視窗 (Modal)**。
   * **功能**：主持人詢問現場誰要許願 -> 若多人則現場 PK -> 主持人直接在視窗中 **輸入/選擇勝者名字** -> 系統更新持有者。
4. **萬能編輯功能 (Manual Override)**
   * **修改**：在主控台的每一張禮物卡片右上角增加 **「✏️ 編輯按鈕」**。
   * **功能**：無論在 R1、S1 或 S2 階段，主持人都可以隨時強制修改禮物的「持有者」。這解決了 S2 交換禮物時的系統操作需求。
5. **鎖定權限移交**
   * **修改**：移除玩家端的鎖定按鈕，僅保留鎖定狀態圖示。
   * **功能**：**鎖定 (Lock)** 與 **解鎖 (Unlock)** 完全由主控台控制，避免玩家手誤或作弊。

---

### 🎮 完整操作流程攻略 (Operation Flow)

請依照以下劇本進行活動：

#### **第 0 階段：入場與準備**

1. **玩家動作**：用手機打開網頁，輸入名字與兩份禮物的超聳動文案，按下「加入戰局」。
2. **主控台**：在大螢幕上會即時看到新增加的禮物卡片（此時持有者顯示「等待抽出...」）。

#### **第 1 階段：R1 好禮物 (理想分配)**

1. **展示**：主持人將主控台切換至 **「R1 好禮物」** 分頁。
2. **許願**：
   * 主持人點選某個禮物，介紹 Slogan。
   * **玩家動作**：想要的人在手機按下 **「🙏 許願」**（按鈕變色）。
3. **分配**：
   * 主持人看現場舉手/許願狀況。
   * **若多人競爭**：現場進行 PK（猜拳/骰子）。
   * **主控台操作**：主持人點擊該卡片的 **「🏆 公布得主 / 進入 PK」** -> 輸入勝者名字 -> 確認。
4. **鎖定決策**：
   * 勝者拆開實體禮物。
   * 主持人問：「要鎖定嗎？」
   * **主控台操作**：依據玩家回答，點擊 **「🔒 鎖定」** 或保持解鎖。
   * *(選做)*：主持人點擊 **「👁️ 揭曉來源」** 公布送禮者。

#### **第 2 階段：S1 鬧禮物 (民主投票)**

1. **切換**：主持人將主控台切換至 **「S1 鬧禮物」** 分頁。
2. **投票**：
   * 主持人選定一個鬧禮物，點擊 **「▶️ 發起投票」**。
   * **玩家畫面**：該卡片會跳動並顯示「👉 進入投票」（此時進行現場手指投票）。
3. **結算**：
   * 主持人點擊 **「⏹️ 結束投票 & 產生受害者」**。
   * *(因系統預設隨機，若需指定特定受害者)*：主持人點擊卡片右上角的 **「✏️」** 修改為最高票者。
4. **強制鎖定**：
   * 若票數過高觸發霸凌條款，主持人直接點擊 **「🔨 強制鎖定」**。

#### **第 3 階段：S2 最終搶奪 (交換)**

1. **順序**：(依據白板或另外的順序表) 叫號上台。
2. **交換**：
   * 玩家指定：「我要用我的 A 跟 Kevin 的 B 交換」。
   * **主控台操作**：
     * 找到 A 禮物 -> 點 **「✏️」** 改持有者為 Kevin。
     * 找到 B 禮物 -> 點 **「✏️」** 改持有者為 原玩家。
3. **結算**：
   * 交換後詢問玩家是否鎖定。
   * **主控台操作**：更新對應的鎖定狀態。
